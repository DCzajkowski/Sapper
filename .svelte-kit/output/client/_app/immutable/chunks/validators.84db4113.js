var re=Object.defineProperty;var ae=(t,e,i)=>e in t?re(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var _=(t,e,i)=>(ae(t,typeof e!="symbol"?e+"":e,i),i);import{p as le}from"./parse.bee59afc.js";import{j as fe}from"./singletons.da3230c8.js";import{s as G,p as j,c as ue,d as P,u as J,g as K,e as Q,q as X,t as ce,v as me}from"./scheduler.3b48bc77.js";import{S as Y,i as x,e as W,a as O,d as p,p as $,t as k,b as ee,f as N,g as de,h as he,j as ve,k as H}from"./index.e543c91d.js";import{w as _e}from"./index.9991ffd9.js";function Ve(t){return fe.apply_action(t)}function Oe(t){const e=JSON.parse(t);return e.data&&(e.data=le(e.data)),e}const ge=t=>({value:t&16}),z=t=>({value:t[4]});function B(t){let e,i,n=(t[7]||t[3])&&t[4]&&U(t);return{c(){n&&n.c(),e=W()},l(s){n&&n.l(s),e=W()},m(s,a){n&&n.m(s,a),O(s,e,a),i=!0},p(s,a){(s[7]||s[3])&&s[4]?n?(n.p(s,a),a&152&&p(n,1)):(n=U(s),n.c(),p(n,1),n.m(e.parentNode,e)):n&&($(),k(n,1,1,()=>{n=null}),ee())},i(s){i||(p(n),i=!0)},o(s){k(n),i=!1},d(s){s&&N(e),n&&n.d(s)}}}function U(t){let e,i,n;const s=t[16].default,a=P(s,t,t[15],z);return{c(){e=de("div"),a&&a.c(),this.h()},l(l){e=he(l,"DIV",{id:!0,class:!0});var u=ve(e);a&&a.l(u),u.forEach(N),this.h()},h(){H(e,"id",t[1]),H(e,"class",i="svelte-use-form-hint "+t[0])},m(l,u){O(l,e,u),a&&a.m(e,null),n=!0},p(l,u){a&&a.p&&(!n||u&32784)&&J(a,s,l,l[15],n?Q(s,l[15],u,ge):K(l[15]),z),(!n||u&2)&&H(e,"id",l[1]),(!n||u&1&&i!==(i="svelte-use-form-hint "+l[0]))&&H(e,"class",i)},i(l){n||(p(a,l),n=!0)},o(l){k(a,l),n=!1},d(l){l&&N(e),a&&a.d(l)}}}function be(t){let e,i,n=!(t[2]&&t[5])&&!t[6]&&B(t);return{c(){n&&n.c(),e=W()},l(s){n&&n.l(s),e=W()},m(s,a){n&&n.m(s,a),O(s,e,a),i=!0},p(s,[a]){!(s[2]&&s[5])&&!s[6]?n?(n.p(s,a),a&100&&p(n,1)):(n=B(s),n.c(),p(n,1),n.m(e.parentNode,e)):n&&($(),k(n,1,1,()=>{n=null}),ee())},i(s){i||(p(n),i=!0)},o(s){k(n),i=!1},d(s){s&&N(e),n&&n.d(s)}}}function Ee(t,e,i){let n,s,a,l,u,d,{$$slots:E={},$$scope:M}=e,{for:y=""}=e,{form:h="svelte-use-form"}=e,{class:T=""}=e,{id:A=void 0}=e,{on:L=""}=e,{hideWhen:g=""}=e,{hideWhenRequired:R=!1}=e,{showWhenUntouched:w=!1}=e;y||(y=j(`${h}_hint-group-name`));const v=j(h);return ue(t,v,m=>i(14,d=m)),t.$$set=m=>{"for"in m&&i(9,y=m.for),"form"in m&&i(10,h=m.form),"class"in m&&i(0,T=m.class),"id"in m&&i(1,A=m.id),"on"in m&&i(11,L=m.on),"hideWhen"in m&&i(12,g=m.hideWhen),"hideWhenRequired"in m&&i(2,R=m.hideWhenRequired),"showWhenUntouched"in m&&i(3,w=m.showWhenUntouched),"$$scope"in m&&i(15,M=m.$$scope)},t.$$.update=()=>{var m,F;t.$$.dirty&16896&&i(7,n=((m=d[y])==null?void 0:m.touched)??{}),t.$$.dirty&16896&&i(13,s=((F=d[y])==null?void 0:F.errors)??{}),t.$$.dirty&12288&&i(6,a=g?s[g]:""),t.$$.dirty&8192&&i(5,l=s.required),t.$$.dirty&10240&&i(4,u=s[L])},[T,A,R,w,u,l,a,n,v,y,h,L,g,s,d,M,E]}class Se extends Y{constructor(e){super(),x(this,e,Ee,be,G,{for:9,form:10,class:0,id:1,on:11,hideWhen:12,hideWhenRequired:2,showWhenUntouched:3})}}const ye=t=>({form:t&1}),Z=t=>({form:t[0]});function pe(t){let e;const i=t[3].default,n=P(i,t,t[2],Z);return{c(){n&&n.c()},l(s){n&&n.l(s)},m(s,a){n&&n.m(s,a),e=!0},p(s,[a]){n&&n.p&&(!e||a&5)&&J(n,i,s,s[2],e?Q(i,s[2],a,ye):K(s[2]),Z)},i(s){e||(p(n,s),e=!0)},o(s){k(n,s),e=!1},d(s){n&&n.d(s)}}}function Le(t,e,i){let{$$slots:n={},$$scope:s}=e,{form:a="svelte-use-form"}=e,{for:l=""}=e;return X(`${a}_hint-group-name`,l),t.$$set=u=>{"form"in u&&i(0,a=u.form),"for"in u&&i(1,l=u.for),"$$scope"in u&&i(2,s=u.$$scope)},[a,l,s,n]}class je extends Y{constructor(e){super(),x(this,e,Le,pe,G,{form:0,for:1})}}const Ce=()=>/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),te="svelte-use-form-webkit-autofill",ke=`
@keyframes ${te} {
    from {}
}

input:-webkit-autofill {
    animation-name: svelte-use-form-webkit-autofill;
}
`;function we(){if(document.getElementById("svelte-use-form-chrome-autofill-styles")===null){const t=document.createElement("style");t.setAttribute("id","svelte-use-form-chrome-autofill-styles"),t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(ke)),document.head.appendChild(t)}}function Me(t,e,i){if(!Ce())return;function n(s){s.animationName.includes(te)&&(t.value||(e.valid=!0,i()))}t.addEventListener("animationstart",n),we()}class V{constructor(e){_(this,"validators");_(this,"errors",{});_(this,"errorMap",{});_(this,"elements",[]);_(this,"valid",!0);_(this,"_touched",!1);_(this,"initial");_(this,"formRef");_(this,"_value","");this.formRef=e.formRef,this.validators=e.validators,this.errorMap=e.errorMap,this.initial=e.value,this.elements=e.elements,this.value=e.value}get value(){return this._value}get touched(){return this._touched}set value(e){this._value=e,this.validate()}set touched(e){this._touched=e,this.elements.forEach(i=>{e?i.classList.add("touched"):i.classList.remove("touched")})}error(e){this.errors={...e,...this.errors},this.valid=!1,this.formRef()._notifyListeners()}change(e){this.value=e,this.elements.forEach(i=>i.value=e),this.formRef()._notifyListeners()}validate(){let e=!0;this.errors={};for(const i of this.validators){const n=i(this.value,this.formRef(),this);if(n){e=!1;for(const s of Object.entries(n)){let[a,l]=s;const u=this.errorMap[a];u&&(l=typeof u=="function"?u(l):u),this.errors[a]=l}}}return this.valid=e,this.elements.forEach(i=>i.setCustomValidity(e?"":"Field is invalid")),e}reset({value:e}={}){const i=e??this.initial;this.elements.forEach(n=>n.value=i),this.value=i,this.touched=!1,this.formRef()._notifyListeners()}}class S{constructor(e,i){_(this,"_notifyListeners");for(const[n,s]of Object.entries(e))this._addControl(n,s.initial,s.validators,[],s.errorMap);this._notifyListeners=i}static create(e,i){return new S(e,i)}get valid(){let e=!0;return this.forEachControl(i=>{i.valid||(e=!1)}),e}get touched(){let e=!0;return this.forEachControl(i=>{i.touched||(e=!1)}),e}get values(){let e={};return this.forEachControl((i,n)=>{e[n]=i.value}),e}set touched(e){this.forEachControl(i=>{i.touched=e}),this._notifyListeners()}reset(){this.forEachControl(e=>e.reset())}_addControl(e,i="",n=[],s=[],a={}){this[e]=new V({value:i,validators:n,elements:s,errorMap:a,formRef:()=>this})}forEachControl(e){for(const[i,n]of Object.entries(this))n instanceof V&&e(n,i)}}class D extends Error{}function Te(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement}function I(t){return t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement||t instanceof HTMLSelectElement}function ne(t){return t.hasAttribute("data-suf-ignore")&&t.getAttribute("data-suf-ignore")==="true"||t.getAttribute("data-suf-ignore")===!0}const ie=_e([]);function ze(t={},e="svelte-use-form"){const i=[];let n=[],s=S.create(t,v),a;l.subscribe=m,l.set=se,X(e,l);function l(r){return u(r),ie.update(o=>[...o,{node:r,form:s,notifyListeners:v}]),{update:()=>{},destroy:()=>{T(),a.disconnect()}}}function u(r){const o=[...C(r,"input")],f=[...C(r,"textarea")],c=[...C(r,"select")],b=[...o,...f];d(b),E(c),R([...b,...c]),M(r),v()}function d(r){for(const o of r){const f=o.name;let c=s[f];if(c)c.elements.push(o),o.type==="radio"&&o instanceof HTMLInputElement&&o.checked&&(c.initial=o.value);else{const b=Ae(o);s._addControl(f,b,[],[o],{}),c=s[f]}switch(o.type){case"checkbox":case"radio":h(o,"click",g);break;default:w(o,c),A(o,c),h(o,"blur",g)}h(o,"input",L)}}function E(r){for(const o of r){const f=o.name,c=s[f];if(c)c.elements.push(o),w(o,c);else{const b=o.value;s._addControl(f,b,[],[o],{})}h(o,"input",L),h(o,"input",g),h(o,"blur",g)}}function M(r){a=new MutationObserver(y),a.observe(r,{childList:!0,subtree:!0})}function y(r){for(const o of r)if(o.type==="childList"){for(const f of o.addedNodes){if(!(I(f)&&!ne(f)))continue;const c=t[f.name];!s[f.name]&&c&&s._addControl(f.name,c.initial,c.validators,[],c.errorMap),Te(f)?d([f]):f instanceof HTMLSelectElement&&E([f])}for(const f of o.removedNodes){if(!(f instanceof HTMLElement))continue;(I(f)?[f]:Re(f)).forEach(b=>{delete s[b.name],n=n.filter(oe=>oe.node!==b)})}}v()}function h(r,o,f){r.addEventListener(o,f),n.push({node:r,event:o,listener:f})}function T(){for(const{node:r,event:o,listener:f}of n)r.removeEventListener(o,f)}function A(r,o){Me(r,o,v);function f(){return r.value!==o.initial?(g({target:r}),!0):!1}f()||setTimeout(()=>f(),100)}function L({target:r}){if(I(r)){const o=r.name,f=s[o];if(!f)throw new D;let c;r.type==="checkbox"&&r instanceof HTMLInputElement?c=r.checked?"checked":"":c=r.value,f.value=c,v()}}function g({target:r}){if(I(r)){const o=s[r.name];if(!o)throw new D;o.touched||L({target:r}),o.touched=!0,r.classList.add("touched"),v()}}function R(r){for(const o of Object.keys(t)){let f=!1;for(const c of r)o===c.name&&(f=!0);f||delete s[o]}}function w(r,o){o.initial&&(r.value=o.initial)}function v(){for(const r of i)r(s)}function m(r){return i.push(r),r(s),{unsubscribe:()=>F(r)}}function F(r){const o=i.indexOf(r);i.splice(o,1)}function se(r){s=r,v()}return l}function Ae(t){let e;return t.type==="radio"&&t instanceof HTMLInputElement?e=t.checked?t.value:"":t.type==="checkbox"&&t instanceof HTMLInputElement?e=t.checked?"checked":"":e=t.value,e}function C(t,e){return Array.from(t.getElementsByTagName(e)).filter(i=>!ne(i))}function Re(t){const e=C(t,"input"),i=C(t,"textarea"),n=C(t,"select");return[...e,...i,...n]}function Be(t,e){let i,n;return s(),{update:a};async function s(){const l=t.form;if(!l)throw new q("HTML element doesn't have an ancestral form");await ce();const u=me(ie).find(E=>E.node===l);if(!u)throw new q("HTML form doesn't have a svelte-use-form binded. (use:form)");n=u;let d=n.form[t.name];if(!(d instanceof V))throw new q(`Form Control [${t.name}] doesn't exist.`);i=d,i.validators.push(...e),i.validate(),n.notifyListeners()}function a(l){if(!i||!n)return;const u=i.validators.filter(d=>!e.find(E=>E===d));u.push(...l),i.validators=u,i.validate(),n.notifyListeners()}}class q extends Error{}const Ue=t=>t.trim()?null:{required:"Required"};function Ze(t){return e=>{if(e.trim().length>t)return{maxLength:t}}}function De(t){return e=>{if(e.trim().length<t)return{minLength:t}}}const Ge=t=>/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(t)?null:{email:{}};function Pe(t){const e=typeof t=="string"?new RegExp(t):t;return i=>e.test(i)?null:{pattern:"Pattern error"}}export{je as H,Se as a,Ve as b,Ze as c,Oe as d,Ge as e,De as m,Pe as p,Ue as r,ze as u,Be as v};
